!------------------------------------------------
      SUBROUTINE GAUSS(M,T,F,ND,UA)
      IMPLICIT REAL*8 (A-H,O-Z)
!===============================================
!===============================================
!
!     Checked on Oct. 23, 2005; and on Oct. 25, 2005 again.
!     
!     It is moved from NML/BONE/TRABE on Aug. 12, 2006     
!
!===============================================
!===============================================
      DOUBLE PRECISION :: T(ND,ND)
      DOUBLE PRECISION :: F(ND),UA(ND)
!===============================================
!===============================================
      DO 100 K=1,M-1
!===============================================
      KMAX=K
      AMAX=DABS(T(K,K))
      DO 1000 KK=K+1,M
      IF(DABS(T(KK,K)).LE.AMAX) GO TO 1000
      AMAX=DABS(T(KK,K))
      KMAX=KK
1000  CONTINUE
      IF(KMAX.EQ.K) GO TO 2500
!===============================================
!===============================================
      DO 2000 J=K,M
      C=T(KMAX,J)
      T(KMAX,J)=T(K,J)
      T(K,J)=C
2000  CONTINUE
      D=F(KMAX)
      F(KMAX)=F(K)
      F(K)=D
2500  CONTINUE
!===============================================
!===============================================
      DO 200 I=K+1,M
      TEST=DABS(T(I,K))
      IF(TEST.LT.1.0D-12) GO TO 200
      FACT = -T(I,K)/T(K,K)
      F(I) = F(I)+FACT*F(K)
!===============================================
      DO 150 J=K+1,M
150   T(I,J) = T(I,J)+FACT*T(K,J)
!===============================================
200   CONTINUE
!===============================================
100   CONTINUE
      UA(M) = F(M)/T(M,M)
      
!===============================================
!===============================================
      DO 400 K=1,M-1
      I = M-K
!===============================================
      DO 500 J=I+1,M
      F(I) = F(I)-T(I,J)*UA(J)
500   CONTINUE
!===============================================
      UA(I) = F(I)/T(I,I)
400   CONTINUE
!===============================================
!===============================================
      RETURN
      END
!-----------------------------------------------
